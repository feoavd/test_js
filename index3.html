<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Викторина о Джо Дассене</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Philosopher:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Pangolin&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #f5f9f5 0%, #e8f2e8 100%);
            color: #2d4a2d;
            line-height: 1.6;
            min-height: 100vh;
            padding-bottom: 40px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Шапка */
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: white;
            font-family: Pangolin;
            box-shadow: 0 5px 20px rgba(76, 124, 76, 0.1);
        }
        
        .header h1 {
            color: #2d5a2d;
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .header p {
            color: #5a7d5a;
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }
        
        main{
            font-family: Philosopher;
        }

        /* Прогресс бар */
        .progress-container {
            width: 100%;
            height: 8px;
            background-color: #e0e9df;
            border-radius: 4px;
            margin-bottom: 30px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #6da76d, #4a8c4a);
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        /* Вопросы */
        .question-container {
            background-color: white;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(76, 124, 76, 0.1);
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .question-container.active {
            display: block;
        }
        
        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e8f0e8;
        }
        
        .question-number {
            font-size: 1.3rem;
            font-weight: 600;
            color: #4a8c4a;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .question-number i {
            font-size: 1.2rem;
        }
        
        .question-points {
            background-color: #e8f0e8;
            color: #4a8c4a;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .question-text {
            font-size: 1.25rem;
            margin-bottom: 20px;
            color: #2d5a2d;
            line-height: 1.5;
        }
        
        .question-image {
            margin: 20px 0;
            text-align: center;
        }
        
        .question-image img {
            max-width: 100%;
            max-height: 300px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        /* Варианты ответов */
        .options {
            margin: 25px 0;
        }
        
        .option {
            background-color: #f9fbf9;
            border: 2px solid #e0e9df;
            border-radius: 10px;
            padding: 16px 20px;
            margin-bottom: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .option:hover {
            background-color: #f0f7f0;
            border-color: #a8c9a8;
            transform: translateY(-2px);
        }
        
        .option.selected {
            background-color: #e8f4e8;
            border-color: #6da76d;
            color: #2d5a2d;
        }
        
        .option.correct {
            background-color: #e8f7e8;
            border-color: #6da76d;
            color: #2d5a2d;
            animation: correctPulse 1s ease;
        }
        
        .option.incorrect {
            background-color: #fdeaea;
            border-color: #e8a8a8;
            color: #8a3a3a;
        }
        
        .option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            background-color: #a8c9a8;
            color: white;
            border-radius: 50%;
            margin-right: 15px;
            font-weight: 600;
            flex-shrink: 0;
        }
        
        .option-text {
            flex: 1;
        }
        
        /* Поля ввода */
        .input-container {
            margin: 25px 0;
        }
        
        .input-answer {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid #e0e9df;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background-color: #f9fbf9;
        }
        
        .input-answer:focus {
            outline: none;
            border-color: #6da76d;
            box-shadow: 0 0 0 3px rgba(109, 167, 109, 0.2);
            background-color: white;
        }
        
        /* Кнопки */
        .check-btn {
            background-color: #6da76d;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 16px 30px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
        }
        
        .check-btn:hover {
            background-color: #5a8d5a;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(109, 167, 109, 0.3);
        }
        
        .check-btn:active {
            transform: translateY(0);
        }
        
        .check-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        /* Сопоставление */
        .matching-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 25px 0;
        }
        
        .matching-column {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .matching-column h3 {
            color: #4a8c4a;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .matching-item {
            background-color: #f9fbf9;
            border: 2px solid #e0e9df;
            border-radius: 10px;
            padding: 16px;
            cursor: move;
            transition: all 0.3s ease;
            user-select: none;
        }
        
        .matching-item:hover {
            background-color: #f0f7f0;
            border-color: #a8c9a8;
        }
        
        .matching-item.dragging {
            opacity: 0.7;
            transform: scale(1.02);
        }
        
        .matching-item.matched {
            background-color: #e8f4e8;
            border-color: #6da76d;
        }
        
        .match-result {
            text-align: center;
            margin-top: 20px;
            font-weight: 500;
            color: #4a8c4a;
            font-size: 1.1rem;
        }
        
        /* Найди на фото */
        .find-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .find-item {
            position: relative;
            cursor: pointer;
            border-radius: 10px;
            overflow: hidden;
            border: 3px solid #e0e9df;
            transition: all 0.3s ease;
        }
        
        .find-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .find-item.selected {
            border-color: #6da76d;
            box-shadow: 0 0 0 3px rgba(109, 167, 109, 0.3);
        }
        
        .find-item.correct {
            border-color: #6da76d;
            box-shadow: 0 0 0 3px rgba(109, 167, 109, 0.5);
            animation: photoPulse 1s ease;
        }
        
        .find-item img {
            width: 100%;
            height: 180px;
            object-fit: cover;
            display: block;
        }
        
        .find-number {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: rgba(255, 255, 255, 0.9);
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: #4a8c4a;
        }
        
        /* Результаты для каждого вопроса */
        .result {
            margin-top: 20px;
            padding: 18px;
            border-radius: 10px;
            font-weight: 500;
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .result.show {
            display: block;
        }
        
        .result.correct {
            background-color: #e8f7e8;
            color: #2d5a2d;
        }
        
        .result.incorrect {
            background-color: #fdeaea;
            color: #8a3a3a;
        }
        
        /* Финальные результаты */
        .result-container {
            background-color: white;
            border-radius: 15px;
            padding: 40px;
            margin: 40px auto;
            max-width: 800px;
            box-shadow: 0 10px 30px rgba(76, 124, 76, 0.15);
            display: none;
            text-align: center;
            animation: fadeIn 0.5s ease;
            border-top: 3px solid #6da76d;
        }
        
        .result-container.show {
            display: block;
        }
        
        .result-content h2 {
            color: #4a8c4a;
            margin-bottom: 25px;
            font-size: 2rem;
        }
        
        .score-display {
            margin: 30px 0;
        }
        
        .score-circle {
            width: 160px;
            height: 160px;
            border-radius: 50%;
            background: linear-gradient(135deg, #a8c9a8, #6da76d);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            margin: 0 auto 30px;
            box-shadow: 0 10px 25px rgba(109, 167, 109, 0.3);
            animation: scorePulse 2s infinite;
        }
        
        .score-circle #totalScore {
            font-size: 3.5rem;
            font-weight: 700;
            line-height: 1;
        }
        
        .score-label {
            font-size: 1.1rem;
            font-weight: 500;
        }
        
        .score-text p {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: #2d5a2d;
        }
        
        .score-text #scoreOutOf {
            font-weight: 700;
            color: #4a8c4a;
        }
        
        .score-message {
            font-size: 1.2rem;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            background-color: #f9fbf9;
            color: #5a7d5a;
            border: 1px solid #e0e9df;
        }
        
        /* Навигация */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        .nav-btn {
            background-color: #a8c9a8;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 14px 28px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .nav-btn:hover {
            background-color: #6da76d;
            transform: translateY(-2px);
        }
        
        .nav-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            transform: none;
        }
        
        /* Анимации */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes correctPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.03); }
            100% { transform: scale(1); }
        }
        
        @keyframes photoPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        @keyframes scorePulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: correctPulse 0.5s ease;
        }
        
        /* Подвал */
        footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 20px;
            color: #7a9a7a;
            font-size: 0.9rem;
            border-top: 1px solid #e0e9df;
        }
        
        /* Адаптивность */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .question-container {
                padding: 20px;
            }
            
            .matching-container {
                grid-template-columns: 1fr;
            }
            
            .find-container {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .score-circle {
                width: 130px;
                height: 130px;
            }
            
            .score-circle #totalScore {
                font-size: 2.8rem;
            }
            
            .nav-buttons {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Прогресс бар -->
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        
        <!-- Шапка -->
        <div class="header">
            <h1>Викторина о Джо Дассене</h1>
            <p>Проверьте свои знания о легендарном французском певце</p>
        </div>
        
        <!-- Вопрос 1 -->
        <div class="question-container active" id="question1">
            <div class="question-header">
                <div class="question-number">
                    Вопрос 1
                </div>
                <div class="question-points">1 балл</div>
            </div>
            <p class="question-text">Полное имя Джо Дассена?</p>
            <div class="question-image">
                <img src="./images/Joe_Dassin_1960s.jpg" alt="Джо Дассен">
            </div>
            
            <div class="options">
                <div class="option" data-question="1" data-value="1">
                    <span class="option-letter">A</span>
                    <span class="option-text">Джозеф Айра Дассен</span>
                </div>
                <div class="option" data-question="1" data-value="2">
                    <span class="option-letter">B</span>
                    <span class="option-text">Сигма Гойдович
                    </span>
                </div>
                <div class="option" data-question="1" data-value="3">
                    <span class="option-letter">C</span>
                    <span class="option-text">Джози Марк Дассен</span>
                </div>
                <div class="option" data-question="1" data-value="4">
                    <span class="option-letter">D</span>
                    <span class="option-text">Джо Пьер Дассен</span>
                </div>
            </div>
            
            <button class="check-btn" id="check1">
                <i class="fas fa-check"></i> Проверить ответ
            </button>
            
            <div class="result" id="result1"></div>
        </div>
        
        <!-- Вопрос 2 -->
        <div class="question-container" id="question2">
            <div class="question-header">
                <div class="question-number">
                    <i class="fas fa-question-circle"></i> Вопрос 2
                </div>
                <div class="question-points">2 балла</div>
            </div>
            <p class="question-text">Сопоставьте названия песен на французском с их переводом на русский</p>
            <div class="question-image">
                <img src="./images/i.webp" alt="Джо Дассен поет">
            </div>
            
            <div class="matching-container" id="matchingContainer">
                <div class="matching-column">
                    <h3>Французские названия</h3>
                    <div class="matching-item" data-id="1">Depuis l'année dernière</div>
                    <div class="matching-item" data-id="2">Et si tu n'existais pas</div>
                    <div class="matching-item" data-id="3">À toi</div>
                </div>
                
                <div class="matching-column">
                    <h3>Русские переводы</h3>
                    <div class="matching-item" data-match="1">С прошлого года</div>
                    <div class="matching-item" data-match="2">Если б не было тебя...</div>
                    <div class="matching-item" data-match="3">За тебя</div>
                </div>
            </div>
            
            <div class="match-result" id="matchResult">Сопоставьте элементы, перетаскивая их</div>
            <button class="check-btn" id="check2">
                <i class="fas fa-check"></i> Проверить сопоставление
            </button>
            
            <div class="result" id="result2"></div>
        </div>
        
        <!-- Вопрос 3 -->
        <div class="question-container" id="question3">
            <div class="question-header">
                <div class="question-number">
                    <i class="fas fa-question-circle"></i> Вопрос 3
                </div>
                <div class="question-points">1 балл</div>
            </div>
            <p class="question-text">Найдите Джо Дассена на фотографиях (выберите правильную)</p>
            
            <div class="find-container">
                <div class="find-item" data-photo="1">
                    <div class="find-number">1</div>
                    <img src="https://i.pinimg.com/736x/9c/6e/a5/9c6ea58bac0afa52127373e887eef959.jpg" alt="Фото 1">
                </div>
                <div class="find-item" data-photo="2">
                    <div class="find-number">2</div>
                    <img src="http://avatars.mds.yandex.net/get-vthumb/3336642/f2ee0e6ffd1020c558ec21489b0135e7/800x450" alt="Фото 2">
                </div>
                <div class="find-item" data-photo="3">
                    <div class="find-number">3</div>
                    <img src="https://avatars.mds.yandex.net/i?id=ddf5fda12ae572c6f8603037b4a416793799ecd9-8185861-images-thumbs&n=13" alt="Фото 3">
                </div>
                <div class="find-item" data-photo="4">
                    <div class="find-number">4</div>
                    <img src="https://avatars.mds.yandex.net/i?id=81e72e2f63d0fe267d5bfc624dbaf8ce_l-9223934-images-thumbs&n=13" alt="Фото 4">
                </div>
                <div class="find-item" data-photo="5">
                    <div class="find-number">5</div>
                    <img src="https://i.pinimg.com/originals/d9/51/92/d95192709d1c8479a1e27a6a21bdaee1.jpg" alt="Фото 5">
                </div>
            </div>
            
            <button class="check-btn" id="check3">
                <i class="fas fa-check"></i> Проверить выбор
            </button>
            
            <div class="result" id="result3"></div>
        </div>
        
        <!-- Вопрос 4 (новый) -->
        <div class="question-container" id="question4">
            <div class="question-header">
                <div class="question-number">
                    <i class="fas fa-question-circle"></i> Вопрос 4
                </div>
                <div class="question-points">1 балл</div>
            </div>
            <p class="question-text">В каком году родился Джо Дассен?</p>
            <div class="question-image">
                <img src="./images/jojo.jpg" alt="Джо Дассен 1969" style="max-height: 250px;">
            </div>
            
            <div class="input-container">
                <input type="number" class="input-answer" id="answer4" placeholder="Введите год рождения" min="1900" max="2000">
            </div>
            
            <button class="check-btn" id="check4">
                <i class="fas fa-check"></i> Проверить ответ
            </button>
            
            <div class="result" id="result4"></div>
        </div>
        
        <!-- Вопрос 5 (новый) -->
        <div class="question-container" id="question5">
            <div class="question-header">
                <div class="question-number">
                    <i class="fas fa-question-circle"></i> Вопрос 5
                </div>
                <div class="question-points">1 балл</div>
            </div>
            <p class="question-text">Какая из этих песен НЕ принадлежит Джо Дассену?</p>
            
            <div class="options">
                <div class="option" data-question="5" data-value="1">
                    <span class="option-letter">A</span>
                    <span class="option-text">"Les Champs-Élysées"</span>
                </div>
                <div class="option" data-question="5" data-value="2">
                    <span class="option-letter">B</span>
                    <span class="option-text">"L'été indien"</span>
                </div>
                <div class="option" data-question="5" data-value="3">
                    <span class="option-letter">C</span>
                    <span class="option-text">"La Bohème"</span>
                </div>
                <div class="option" data-question="5" data-value="4">
                    <span class="option-letter">D</span>
                    <span class="option-text">"Salut les amoureux"</span>
                </div>
            </div>
            
            <button class="check-btn" id="check5">
                <i class="fas fa-check"></i> Проверить ответ
            </button>
            
            <div class="result" id="result5"></div>
        </div>
        
        <!-- Вопрос 6 (новый) -->
        <div class="question-container" id="question6">
            <div class="question-header">
                <div class="question-number">
                    <i class="fas fa-question-circle"></i> Вопрос 6
                </div>
                <div class="question-points">1 балл</div>
            </div>
            <p class="question-text">Из какой страны был отец Джо Дассена?</p>
            
            <div class="options">
                <div class="option" data-question="6" data-value="1">
                    <span class="option-letter">A</span>
                    <span class="option-text">Франция</span>
                </div>
                <div class="option" data-question="6" data-value="2">
                    <span class="option-letter">B</span>
                    <span class="option-text">США</span>
                </div>
                <div class="option" data-question="6" data-value="3">
                    <span class="option-letter">C</span>
                    <span class="option-text">Россия</span>
                </div>
                <div class="option" data-question="6" data-value="4">
                    <span class="option-letter">D</span>
                    <span class="option-text">Италия</span>
                </div>
            </div>
            
            <button class="check-btn" id="check6">
                <i class="fas fa-check"></i> Проверить ответ
            </button>
            
            <div class="result" id="result6"></div>
        </div>
        
        <!-- Вопрос 7 (новый) -->
        <div class="question-container" id="question7">
            <div class="question-header">
                <div class="question-number">
                    <i class="fas fa-question-circle"></i> Вопрос 7
                </div>
                <div class="question-points">1 балл</div>
            </div>
            <p class="question-text">Какая песня Джо Дассена стала неофициальным гимном Парижа?</p>
            
            <div class="options">
                <div class="option" data-question="7" data-value="1">
                    <span class="option-letter">A</span>
                    <span class="option-text">"Les Champs-Élysées"</span>
                </div>
                <div class="option" data-question="7" data-value="2">
                    <span class="option-letter">B</span>
                    <span class="option-text">"L'été indien"</span>
                </div>
                <div class="option" data-question="7" data-value="3">
                    <span class="option-letter">C</span>
                    <span class="option-text">"À toi"</span>
                </div>
                <div class="option" data-question="7" data-value="4">
                    <span class="option-letter">D</span>
                    <span class="option-text">"Et si tu n'existais pas"</span>
                </div>
            </div>
            
            <button class="check-btn" id="check7">
                <i class="fas fa-check"></i> Проверить ответ
            </button>
            
            <div class="result" id="result7"></div>
        </div>
        
        <!-- Финальные результаты -->
        <div class="result-container" id="finalResult">
            <div class="result-content">
                <h2>Результаты викторины</h2>
                <div class="score-display">
                    <div class="score-circle">
                        <span id="totalScore">0</span>
                        <span class="score-label">баллов</span>
                    </div>
                    <div class="score-text">
                        <p>Вы набрали <span id="scoreOutOf">0</span> из 8 возможных баллов</p>
                        <div class="score-message" id="scoreMessage"></div>
                    </div>
                </div>
                
                <div class="nav-buttons">
                    <button class="nav-btn" id="retryBtn">
                        <i class="fas fa-redo"></i> Пройти заново
                    </button>
                    <button class="nav-btn" id="backBtn">
                        <i class="fas fa-arrow-left"></i> Вернуться к Лазареву
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Подвал -->
        <footer>
            <p>Разработали сайт: ИСП-323-р Мухина Алина И Софья Полина</p>
        </footer>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Конфигурация викторины
            const quizConfig = {
                totalQuestions: 7,
                correctAnswers: {
                    1: "1", // Полное имя: Джозеф Айра Дассен
                    2: {"1": "1", "2": "2", "3": "3"}, // Сопоставление песен
                    3: "3", // Найди на фото: 3 фото
                    4: "1938", // Год рождения
                    5: "3", // Какая песня НЕ принадлежит: "La Bohème"
                    6: "2", // Отец из США
                    7: "1" // Песня-гимн Парижа: "Les Champs-Élysées"
                },
                scores: {
                    1: 1,
                    2: 2,
                    3: 1,
                    4: 1,
                    5: 1,
                    6: 1,
                    7: 1
                }
            };
            
            // Переменные состояния
            let currentQuestion = 1;
            let userAnswers = {};
            let totalScore = 0;
            let matchedPairs = {};
            let dragSource = null;
            
            // Инициализация
            initQuiz();
            
            // Функция инициализации викторины
            function initQuiz() {
                showQuestion(currentQuestion);
                updateProgressBar();
                setupEventListeners();
            }
            
            // Показать вопрос
            function showQuestion(questionNumber) {
                // Скрыть все вопросы и результаты
                document.querySelectorAll('.question-container, .result-container').forEach(q => {
                    q.classList.remove('active', 'show');
                });
                
                // Показать нужный вопрос
                const questionElement = document.getElementById(`question${questionNumber}`);
                if (questionElement) {
                    questionElement.classList.add('active');
                    questionElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
                
                // Обновить прогресс-бар
                updateProgressBar();
            }
            
            // Обновить прогресс-бар
            function updateProgressBar() {
                const progress = ((currentQuestion - 1) / quizConfig.totalQuestions) * 100;
                document.getElementById('progressBar').style.width = `${progress}%`;
            }
            
            // Настройка обработчиков событий
            function setupEventListeners() {
                // Вопросы с выбором одного варианта
                for (let i = 1; i <= 7; i++) {
                    if (i !== 2 && i !== 3 && i !== 4) {
                        setupSingleChoiceQuestion(i);
                    }
                }
                
                // Вопрос 2: Сопоставление
                setupMatchingQuestion(2);
                
                // Вопрос 3: Найди на фото
                setupFindPhotoQuestion(3);
                
                // Вопрос 4: Числовой ввод
                setupNumberInputQuestion(4);
                
                // Кнопки навигации
                document.getElementById('retryBtn').addEventListener('click', retryQuiz);
                document.getElementById('backBtn').addEventListener('click', function() {
                    window.location.href = 'index.html';
                });
            }
            
            // Вопрос с выбором одного варианта
            function setupSingleChoiceQuestion(questionNumber) {
                const options = document.querySelectorAll(`.option[data-question="${questionNumber}"]`);
                const checkBtn = document.getElementById(`check${questionNumber}`);
                const resultElement = document.getElementById(`result${questionNumber}`);
                
                options.forEach(option => {
                    option.addEventListener('click', function() {
                        // Снять выделение с других вариантов
                        options.forEach(opt => {
                            opt.classList.remove('selected');
                        });
                        
                        // Выделить выбранный вариант
                        this.classList.add('selected');
                        
                        // Сохранить ответ пользователя
                        userAnswers[questionNumber] = this.getAttribute('data-value');
                        
                        // Активировать кнопку проверки
                        checkBtn.disabled = false;
                    });
                });
                
                // Кнопка проверки
                checkBtn.addEventListener('click', function() {
                    if (!userAnswers[questionNumber]) {
                        showResult(questionNumber, false, "Пожалуйста, выберите вариант ответа");
                        return;
                    }
                    
                    checkAnswer(questionNumber);
                    this.disabled = true;
                });
            }
            
            // Вопрос с сопоставлением
            function setupMatchingQuestion(questionNumber) {
                const matchingItems = document.querySelectorAll('#matchingContainer .matching-item');
                const checkBtn = document.getElementById(`check${questionNumber}`);
                const resultElement = document.getElementById(`result${questionNumber}`);
                const matchResult = document.getElementById('matchResult');
                
                // Сбросить сопоставления
                matchedPairs = {};
                
                // Настройка drag-and-drop
                matchingItems.forEach(item => {
                    item.setAttribute('draggable', 'true');
                    
                    // События для перетаскивания
                    item.addEventListener('dragstart', function(e) {
                        dragSource = this;
                        this.classList.add('dragging');
                        e.dataTransfer.setData('text/plain', this.getAttribute('data-id') || this.getAttribute('data-match'));
                    });
                    
                    item.addEventListener('dragover', function(e) {
                        e.preventDefault();
                    });
                    
                    item.addEventListener('dragenter', function(e) {
                        e.preventDefault();
                        if (this !== dragSource) {
                            this.style.backgroundColor = '#f0f7f0';
                        }
                    });
                    
                    item.addEventListener('dragleave', function() {
                        if (this !== dragSource) {
                            this.style.backgroundColor = '';
                        }
                    });
                    
                    item.addEventListener('drop', function(e) {
                        e.preventDefault();
                        if (this === dragSource) return;
                        
                        // Получаем данные о перетаскиваемом элементе
                        const sourceId = dragSource.getAttribute('data-id');
                        const sourceMatch = dragSource.getAttribute('data-match');
                        const targetId = this.getAttribute('data-id');
                        const targetMatch = this.getAttribute('data-match');
                        
                        // Проверяем, можно ли сопоставить эти элементы
                        if ((sourceId && targetMatch) || (sourceMatch && targetId)) {
                            // Сопоставляем элементы
                            const pairId = sourceId || sourceMatch;
                            const matchId = targetMatch || targetId;
                            
                            // Сохраняем сопоставление
                            matchedPairs[pairId] = matchId;
                            
                            // Визуально отмечаем сопоставленные элементы
                            dragSource.classList.add('matched');
                            this.classList.add('matched');
                            
                            // Обновляем текст результата
                            updateMatchResult();
                            
                            // Звуковой эффект
                            playSoundEffect('match');
                        }
                        
                        // Сбрасываем стили
                        this.style.backgroundColor = '';
                        dragSource.classList.remove('dragging');
                        dragSource = null;
                    });
                    
                    item.addEventListener('dragend', function() {
                        this.classList.remove('dragging');
                        this.style.backgroundColor = '';
                    });
                });
                
                // Кнопка проверки
                checkBtn.addEventListener('click', function() {
                    if (Object.keys(matchedPairs).length !== 3) {
                        showResult(questionNumber, false, "Пожалуйста, сопоставьте все 3 пары");
                        return;
                    }
                    
                    checkAnswer(questionNumber);
                    this.disabled = true;
                });
                
                // Функция обновления результата сопоставления
                function updateMatchResult() {
                    const matchedCount = Object.keys(matchedPairs).length;
                    matchResult.textContent = `Сопоставлено: ${matchedCount} из 3`;
                    matchResult.style.color = matchedCount === 3 ? '#2d5a2d' : '#5a7d5a';
                    matchResult.style.fontWeight = '600';
                }
                
                // Инициализация
                updateMatchResult();
            }
            
            // Вопрос "Найди на фото"
            function setupFindPhotoQuestion(questionNumber) {
                const photoItems = document.querySelectorAll('.find-item');
                const checkBtn = document.getElementById(`check${questionNumber}`);
                
                photoItems.forEach(item => {
                    item.addEventListener('click', function() {
                        // Снять выделение с других фото
                        photoItems.forEach(photo => {
                            photo.classList.remove('selected');
                        });
                        
                        // Выделить выбранное фото
                        this.classList.add('selected');
                        
                        // Сохранить ответ пользователя
                        userAnswers[questionNumber] = this.getAttribute('data-photo');
                        
                        // Звуковой эффект
                        playSoundEffect('click');
                    });
                });
                
                // Кнопка проверки
                checkBtn.addEventListener('click', function() {
                    if (!userAnswers[questionNumber]) {
                        showResult(questionNumber, false, "Пожалуйста, выберите фотографию");
                        return;
                    }
                    
                    checkAnswer(questionNumber);
                    this.disabled = true;
                });
            }
            
            // Вопрос с числовым вводом
            function setupNumberInputQuestion(questionNumber) {
                const input = document.getElementById(`answer${questionNumber}`);
                const checkBtn = document.getElementById(`check${questionNumber}`);
                
                // Разрешить нажатие Enter для проверки
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        checkBtn.click();
                    }
                });
                
                checkBtn.addEventListener('click', function() {
                    const userAnswer = input.value.trim();
                    
                    if (!userAnswer) {
                        showResult(questionNumber, false, "Пожалуйста, введите ответ");
                        return;
                    }
                    
                    userAnswers[questionNumber] = userAnswer;
                    checkAnswer(questionNumber);
                    this.disabled = true;
                });
            }
            
            // Проверить ответ на вопрос
            function checkAnswer(questionNumber) {
                const userAnswer = userAnswers[questionNumber];
                const correctAnswer = quizConfig.correctAnswers[questionNumber];
                const resultElement = document.getElementById(`result${questionNumber}`);
                
                let isCorrect = false;
                let message = "";
                
                // Проверка в зависимости от типа вопроса
                switch(questionNumber) {
                    case 1:
                    case 3:
                    case 4:
                    case 5:
                    case 6:
                    case 7:
                        // Простые сравнения
                        isCorrect = String(userAnswer) === String(correctAnswer);
                        message = isCorrect 
                            ? getCorrectMessage(questionNumber) 
                            : getIncorrectMessage(questionNumber);
                        break;
                        
                    case 2:
                        // Сопоставление
                        isCorrect = checkMatchingAnswer();
                        if (isCorrect) {
                            message = "Отлично! Вы правильно сопоставили все песни!";
                        } else {
                            const correctCount = countCorrectMatches();
                            message = `Почти правильно! Вы верно сопоставили ${correctCount} из 3 пар.`;
                        }
                        break;
                }
                
                // Показать результат
                showResult(questionNumber, isCorrect, message);
                
                // Если ответ правильный, добавляем баллы
                if (isCorrect && !userAnswers[`${questionNumber}_scored`]) {
                    totalScore += quizConfig.scores[questionNumber];
                    userAnswers[`${questionNumber}_scored`] = true;
                    
                    // Для вопросов с вариантами подсветить правильные
                    if ([1, 5, 6, 7].includes(questionNumber)) {
                        highlightCorrectAnswer(questionNumber);
                    }
                    
                    // Для вопроса с фото подсветить правильное
                    if (questionNumber === 3) {
                        highlightCorrectPhoto();
                    }
                    
                    // Звуковой эффект для правильного ответа
                    playSoundEffect('correct');
                } else if (!isCorrect) {
                    // Звуковой эффект для неправильного ответа
                    playSoundEffect('incorrect');
                }
                
                // Перейти к следующему вопросу через 2 секунды
                setTimeout(() => {
                    nextQuestion();
                }, 2000);
            }
            
            // Проверка сопоставления для вопроса 2
            function checkMatchingAnswer() {
                const correctPairs = quizConfig.correctAnswers[2];
                let allCorrect = true;
                
                for (const [key, value] of Object.entries(correctPairs)) {
                    if (matchedPairs[key] !== value) {
                        allCorrect = false;
                        break;
                    }
                }
                
                return allCorrect && Object.keys(matchedPairs).length === Object.keys(correctPairs).length;
            }
            
            // Подсчет правильных сопоставлений
            function countCorrectMatches() {
                const correctPairs = quizConfig.correctAnswers[2];
                let correctCount = 0;
                
                for (const [key, value] of Object.entries(correctPairs)) {
                    if (matchedPairs[key] === value) {
                        correctCount++;
                    }
                }
                
                return correctCount;
            }
            
            // Подсветить правильный ответ для вопросов с выбором
            function highlightCorrectAnswer(questionNumber) {
                const correctAnswer = quizConfig.correctAnswers[questionNumber];
                const options = document.querySelectorAll(`.option[data-question="${questionNumber}"]`);
                
                options.forEach(option => {
                    const optionValue = option.getAttribute('data-value');
                    if (optionValue === correctAnswer) {
                        option.classList.add('correct');
                    }
                });
            }
            
            // Подсветить правильное фото
            function highlightCorrectPhoto() {
                const correctPhoto = quizConfig.correctAnswers[3];
                const photoItems = document.querySelectorAll('.find-item');
                
                photoItems.forEach(item => {
                    if (item.getAttribute('data-photo') === correctPhoto) {
                        item.classList.add('correct');
                    }
                });
            }
            
            // Показать результат для вопроса
            function showResult(questionNumber, isCorrect, message) {
                const resultElement = document.getElementById(`result${questionNumber}`);
                
                // Обновить стиль и текст
                resultElement.textContent = message;
                resultElement.className = `result ${isCorrect ? 'correct' : 'incorrect'} show`;
                
                // Добавить анимацию
                resultElement.classList.add('pulse');
                setTimeout(() => {
                    resultElement.classList.remove('pulse');
                }, 500);
            }
            
            // Перейти к следующему вопросу
            function nextQuestion() {
                // Скрыть текущий вопрос
                document.getElementById(`question${currentQuestion}`).classList.remove('active');
                
                // Увеличить номер текущего вопроса
                currentQuestion++;
                
                // Если вопросы закончились, показать результаты
                if (currentQuestion > quizConfig.totalQuestions) {
                    showFinalResults();
                } else {
                    // Показать следующий вопрос
                    showQuestion(currentQuestion);
                }
                
                // Обновить прогресс-бар
                updateProgressBar();
            }
            
            // Показать финальные результаты
            function showFinalResults() {
                const resultContainer = document.getElementById('finalResult');
                const totalScoreElement = document.getElementById('totalScore');
                const scoreOutOfElement = document.getElementById('scoreOutOf');
                const scoreMessageElement = document.getElementById('scoreMessage');
                
                // Вычислить максимально возможный балл
                const maxScore = Object.values(quizConfig.scores).reduce((a, b) => a + b, 0);
                
                // Обновить отображение результатов
                totalScoreElement.textContent = totalScore;
                scoreOutOfElement.textContent = `${totalScore} из ${maxScore}`;
                
                // Показать сообщение в зависимости от результата
                let message = "";
                if (totalScore === maxScore) {
                    message = "Потрясающе! Вы настоящий эксперт по Джо Дассену! Идеальный результат!";
                } else if (totalScore >= maxScore * 0.8) {
                    message = "Отличный результат! Вы отлично знаете творчество Джо Дассена!";
                } else if (totalScore >= maxScore * 0.6) {
                    message = "Хороший результат! Вы знакомы с творчеством Джо Дассена.";
                } else if (totalScore >= maxScore * 0.4) {
                    message = "Неплохой результат! Вы знаете основные факты о Джо Дассене.";
                } else {
                    message = "Есть куда стремиться! Послушайте больше песен Джо Дассена!";
                }
                
                scoreMessageElement.textContent = message;
                
                // Показать контейнер с результатами
                resultContainer.classList.add('show');
                
                // Прокрутить к результатам
                resultContainer.scrollIntoView({ behavior: 'smooth' });
                
                // Звуковой эффект для завершения
                playSoundEffect('finish');
            }
            
            // Начать викторину заново
            function retryQuiz() {
                // Сбросить состояние
                currentQuestion = 1;
                userAnswers = {};
                totalScore = 0;
                matchedPairs = {};
                dragSource = null;
                
                // Сбросить визуальное состояние
                document.querySelectorAll('.option, .find-item, .matching-item').forEach(el => {
                    el.classList.remove('selected', 'correct', 'incorrect', 'matched');
                });
                
                document.querySelectorAll('.input-answer').forEach(input => {
                    input.value = '';
                });
                
                document.querySelectorAll('.check-btn').forEach(btn => {
                    btn.disabled = false;
                });
                
                document.getElementById('matchResult').textContent = 'Сопоставьте элементы, перетаскивая их';
                
                // Перезапустить викторину
                initQuiz();
                
                // Прокрутить к началу
                document.querySelector('.header').scrollIntoView({ behavior: 'smooth' });
            }
            
            
            // Вспомогательные функции для сообщений
            function getCorrectMessage(questionNumber) {
                const messages = {
                    1: "Правильно! Полное имя Джо Дассена — Джозеф Айра Дассен.",
                    3: "Верно! Джо Дассен на третьей фотографии.",
                    4: "Точно! Джо Дассен родился в 1938 году в Нью-Йорке.",
                    5: "Правильно! 'La Bohème' — это песня Шарля Азнавура, а не Джо Дассена.",
                    6: "Верно! Отец Джо Дассена, Жюль Дассен, был известным кинорежиссёром из США.",
                    7: "Точно! 'Les Champs-Élysées' считается неофициальным гимном Парижа."
                };
                return messages[questionNumber] || "Правильный ответ!";
            }
            
            function getIncorrectMessage(questionNumber) {
                const messages = {
                    1: "Неверно. Правильный ответ: Джозеф Айра Дассен.",
                    3: "Неправильно. Джо Дассен на третьей фотографии.",
                    4: "Неверно. Джо Дассен родился в 1938 году в Нью-Йорке.",
                    5: "Неправильно. 'La Bohème' — это песня Шарля Азнавура, а не Джо Дассена.",
                    6: "Неверно. Отец Джо Дассена был из США, он был известным кинорежиссёром.",
                    7: "Неправильно. 'Les Champs-Élysées' считается неофициальным гимном Парижа."
                };
                return messages[questionNumber] || "Попробуйте еще раз!";
            }
        });
    </script>
</body>
</html>
